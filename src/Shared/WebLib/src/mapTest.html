<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Use correct character set. -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no" />
    <title>MapView Test</title>
    <base target="_blank" />
    <style>

        /* set size of infobox to fill 80% of the whole mobile screen */
        .cesium-infoBox {
            width: 80% !important;
            max-width: 80% !important;
        }
    </style>
</head>
<body class="map-element-fullscreen" style="margin: 0px; background-color: black">

    <div style="position: absolute; top: 0px; margin: 10px; z-index: 100; width: 100vw">
        <select name="mapShadingMode" onChange="map.setShadingMode(this.value.toString())">
            <option value="Fixed10Am">Fixed at 10 am.</option>
            <option value="Fixed3Pm">Fixed at 3 pm.</option>
            <option value="CurrentTime">Current time</option>
            <option value="Ahead6Hours">Current time + 6 hours</option>
            <option value="None">No shading</option>
        </select>

        <select name="mapImageryType" onChange="map.setMapImageryType(this.value.toString())">
            <option value="OpenStreetMap">OpenStreetMap</option>
            <option value="BingMapsAerialWithLabels">Bing maps Aerial with labels</option>
            <option value="OpenTopoMap">OpenTopoMap</option>
        </select>

        <select name="mapOverlayType" onChange="map.setMapOverlayType(this.value.toString())">
            <option value="None">None</option>
            <option value="ThermalSkywaysKk7">kk7 thermal skyways</option>
            <option value="ContourLines">Contour lines</option>
            <option value="SlopeAndContourLines">Slope + contour lines</option>
            <option value="BlackMarble">NASA Black Marble 2017</option>
        </select>

        <button onclick="map.addViewerInspector()">Add inspector</button>

        <button onclick="map.updateMyLocation({latitude: 47.666283, longitude: 11.886159, zoomToLocation: true})">Fly to my position</button>

        <button onclick="map.zoomToLocation({latitude: 47.6764385, longitude: 11.8710533})">Fly to summit</button>

        <button onclick="showFindResult()">Show find result</button>

        <button onclick="addManyLocations()">Add many locations</button>

        <button onclick="addTrack()">Add track</button>

        <button onclick="addFlightTrack()">Add flight track</button>

        <button onclick="zoomToFlightTrack()">Zoom to flight track</button>

        <button onclick="sampleFlightTrackHeights()">Sample flight track heights</button>

        <button onclick="addOsmBuildingsLayer()">Add OSM Buildings layer</button>

        <button onclick="removeOsmBuildingsLayer()">Remove OSM Buildings layer</button>

        <button onclick="addTakeoffLocation()">Add Takeoff</button>

        <button onclick="addLayer()">Add layer</button>

        <button onclick="removeLayer()">Remove layer</button>

        <button onclick="showFlyingRange()">Show flying range</button>

        <button onclick="addLiveTrack()">Add live track</button>

        <button onclick="updateLiveTrack()">Update live track</button>

        <button onclick="zoomToLiveTrack()">Zoom to live track</button>

        <button onclick="removeLiveTrack()">Remove live track</button>

        <button onclick="setCompassTarget()">Set compass target</button>
        <button onclick="setCompassDirection()">Set compass direction</button>
        <button onclick="clearCompass()">Clear compass</button>
        <button onclick="changeMyPosition()">Change my position</button>
    </div>

    <div id="messageBand" class="message-band" style="top: 60px"></div>

    <div id="mapElement" class="map-element-fullscreen"></div>

    <div class="toolbar-container toolbar-container-halftransparent">
        <div id="liveTrackToolbar" class="livetrack-toolbar-container" style="display:none"></div>

        <div id="chartContainer" class="chart-and-toolbar-container chart-and-toolbar-container-outer" style="display:none">
            <div class="chart-toolbar-container">
                <div id="chartButtonClose"
                     class="chart-toolbar-button"
                     onclick="javascript:map.heightProfileView.hide();">
                    <img class="chart-toolbar-button-image" src="images/close.svg" alt="close" />
                </div>

                <div id="chartButtonResetZoom"
                     class="chart-toolbar-button"
                     onclick="javascript:map.heightProfileView.resetZoom();">
                    <img class="chart-toolbar-button-image" src="images/arrow-expand-horizontal.svg" alt="reset" />
                </div>

                <div id="chartButtonModeHover"
                     class="chart-toolbar-button chart-toolbar-button-disabled"
                     style="margin-left:0px;"
                     onclick="javascript:map.heightProfileView.setModeHover();">
                    <img class="chart-toolbar-button-image" src="images/gesture-tap.svg" alt="hover" />
                </div>

                <div id="chartButtonModeZoomAndPan"
                     class="chart-toolbar-button"
                     style="margin-right:0px;"
                     onclick="javascript:map.heightProfileView.setModeZoomAndPan();">
                    <img class="chart-toolbar-button-image" src="images/gesture-spread.svg" alt="zoom and pan" />
                </div>
            </div>
            <div>
                <canvas id="chartElement" class="chart-canvas"></canvas>
            </div>
        </div>
    </div>

    <script type="module">

        // function used to call to C#
        function callAction(funcName, params) {
            console.log("callback://" + funcName + "/" + JSON.stringify(params));
        }

        let map = new WhereToFly.mapView.MapView({
            id: 'mapElement',
            messageBandId: 'messageBand',
            liveTrackToolbarId: 'liveTrackToolbar',
            callback: callAction,
            initialCenterPoint: { latitude: 47.6764385, longitude: 11.8710533 },
            initialViewingDistance: 5000.0
        });

        window.map = map;

        map.setMapImageryType('OpenStreetMap');
        map.setMapOverlayType('None');
        map.setShadingMode('CurrentTime');

        map.addLocationList([
            { "id": "{cc8fa282-10fb-4bab-8af2-0a31f5d528a3}", "name": "Brecherspitz", "description": "Herrliche Aussicht über die drei Seen Schliersee im Norden, Tegernsee im Westen und den Spitzingsee im Süden.", "type": "Summit", "latitude": 47.6764385, "longitude": 11.8710533, "elevation": 1685 },
            { "id": "{d5012732-c371-4b46-9b28-a0aa7a3e47c7}", "name": "Jägerkamp", "description": "Gipfel in den Schlierseer Bergen, mit Ausblick auf Schliersee und die umliegenden Berge.", "type": "Summit", "latitude": 47.673511, "longitude": 11.9060494, "elevation": 1746 },
            { "id": "{2121170e-2f6f-49bd-8f57-b8d64d8b38bb}", "name": "Ankel-Alm", "description": "Privat bewirtschaftete Alm; Montag Ruhetag", "type": "AlpineHut", "latitude": 47.6838571, "longitude": 11.8687695, "elevation": 1311 },
            { "id": "{a963bac3-c573-4498-80d3-447ddeb9494a}", "name": "Schönfeldhütte", "description": "Alpenvereinshütte der Sektion München des DAV", "type": "AlpineHut", "latitude": 47.66508, "longitude": 11.90612, "elevation": 1410 },
            { "id": "{807a72a2-34b9-486d-9f5a-24b404a797ae}", "name": "Spitzingsattel", "description": "Sattel auf halbem Wege zwischen Schliersee und Spitzingsee", "type": "Pass", "latitude": 47.672138, "longitude": 11.8862728, "elevation": 1129 },
            { "id": "{ec0a1a47-b67e-42f1-b6d2-322d259ca729}", "name": "Bahnhof Neuhaus (Schliersee)", "description": "Anschlussmöglichkeiten zum RBO Bus 9562 zum Spitzingsattel", "type": "PublicTransportTrain", "latitude": 47.70599, "longitude": 11.87451, "elevation": 809 },
            { "id": "{4064d1f0-a476-4fe8-973f-f784cae39790}", "name": "RBO Bus 9562 Bushaltestelle Spitzingsattel", "description": "Haltestelle am Spitzingsattel. Abfahrtszeiten Richtung Schliersee: 8:42, 11:15, 15:31, 18:02.", "type": "PublicTransportBus", "latitude": 47.672138, "longitude": 11.8862728, "elevation": 1129 }
        ]);

        setTimeout(function () {
            map.updateMyLocation({
                latitude: 47.666283,
                longitude: 11.886159,
                altitude: 1084,
                displayLatitude: '47°39\'58.6"N',
                displayLongitude: '11°53\'10.2"E',
                displayTimestamp: '2018-01-07 12:01:54',
                zoomTo: false
            });
        }, 2000);

        window.showFindResult = function () {
            map.showFindResult({
                name: 'Bodenschneid',
                description: 'Beschreibung',
                latitude: 47.6717531,
                longitude: 11.8381005,
                altitude: 1667,
                displayLatitude: '47°40\'18.3"N',
                displayLongitude: '11°50\'17.2"E'
            });
        }

        window.addTrack = function () {
            window.theTrack = {
                id: 'crossingthealps2018',
                name: 'Crossing the Alps 2018',
                isFlightTrack: false,
                listOfTrackPoints: [12.352277, 47.754076, 0, 12.432716, 47.630431, 0, 12.29676, 47.285013, 0, 12.183008, 47.090525, 0, 11.958434, 46.738669, 0, 11.787137, 46.296141, 0, 11.904684, 46.017666, 0],
                color: "FF0000"
            };
            map.addTrack(window.theTrack);
        }

        window.addFlightTrack = function () {
            window.theFlight = {
                id: 'thermal-circles',
                name: 'Thermal Circles',
                isFlightTrack: true,
                listOfTrackPoints: [11.896977,47.693005,1414.74,11.896964,47.69302,1414.46,11.896951,47.693035,1414.16,11.896938,47.69305,1413.84,11.896926,47.693065,1413.5,11.896913,47.693081,1413.16,11.896901,47.693096,1412.82,11.896889,47.693113,1412.48,11.896878,47.693129,1412.14,11.896866,47.693146,1411.8,11.896855,47.693164,1411.44,11.896843,47.693181,1411.07,11.896833,47.693198,1410.69,11.896822,47.693216,1410.29,11.896812,47.693233,1409.88,11.896801,47.693251,1409.46,11.89679,47.693269,1409.04,11.896778,47.693289,1408.6,11.896766,47.693308,1408.14,11.896754,47.693329,1407.68,11.896741,47.693349,1407.22,11.896728,47.693368,1406.78,11.896714,47.693387,1406.36,11.8967,47.693405,1405.93,11.896685,47.693423,1405.53,11.89667,47.693441,1405.14,11.896655,47.693458,1404.78,11.896639,47.693475,1404.45,11.896624,47.693492,1404.13,11.896608,47.693508,1403.85,11.896592,47.693524,1403.6,11.896575,47.69354,1403.41,11.896558,47.693555,1403.29,11.896541,47.69357,1403.23,11.896523,47.693585,1403.21,11.896506,47.693599,1403.2,11.896488,47.693614,1403.18,11.896471,47.693628,1403.16,11.896454,47.693641,1403.15,11.896437,47.693655,1403.14,11.896421,47.693668,1403.12,11.896405,47.693682,1403.08,11.89639,47.693696,1403.02,11.896375,47.69371,1402.95,11.896361,47.693724,1402.85,11.896347,47.693738,1402.75,11.896334,47.693752,1402.63,11.896322,47.693766,1402.5,11.896309,47.69378,1402.36,11.896298,47.693793,1402.21,11.896287,47.693807,1402.02,11.896276,47.69382,1401.79,11.896267,47.693833,1401.51,11.896257,47.693846,1401.19,11.896249,47.693858,1400.83,11.89624,47.69387,1400.45,11.896232,47.693882,1400.05,11.896224,47.693893,1399.59,11.896216,47.693904,1399.08,11.896208,47.693914,1398.56,11.896199,47.693925,1398.06,11.89619,47.693935,1397.64,11.896179,47.693946,1397.26,11.896168,47.693956,1396.9,11.896156,47.693967,1396.59,11.896143,47.693977,1396.36,11.896129,47.693987,1396.24,11.896113,47.693996,1396.24,11.896096,47.694005,1396.36,11.896079,47.694014,1396.55,11.896061,47.694023,1396.79,11.896042,47.694032,1397.05,11.896023,47.694041,1397.35,11.896003,47.69405,1397.71,11.895982,47.694059,1398.1,11.895962,47.694068,1398.5,11.895943,47.694077,1398.9,11.895924,47.694087,1399.29,11.895906,47.694098,1399.69,11.895888,47.694109,1400.1,11.895871,47.69412,1400.5,11.895856,47.694131,1400.87,11.895842,47.694142,1401.24,11.89583,47.694153,1401.6,11.895818,47.694165,1401.95,11.895808,47.694176,1402.26,11.895797,47.694187,1402.53,11.895788,47.694197,1402.75,11.89578,47.694207,1402.95,11.895772,47.694216,1403.1,11.895763,47.694225,1403.2,11.895754,47.694232,1403.24,11.895744,47.69424,1403.19,11.895733,47.694247,1403.06,11.895722,47.694253,1402.89,11.895709,47.694258,1402.71,11.895696,47.694262,1402.55,11.895681,47.694264,1402.4,11.895664,47.694265,1402.23,11.895647,47.694264,1402.07,11.895629,47.694262,1401.95,11.895611,47.694259,1401.88,11.895591,47.694253,1401.89,11.895571,47.694246,1401.97,11.89555,47.694237,1402.08,11.895531,47.694227,1402.16,11.895513,47.694215,1402.19,11.895497,47.694201,1402.12,11.895481,47.694185,1401.99,11.895468,47.694168,1401.84,11.895457,47.69415,1401.7,11.895449,47.69413,1401.61,11.895444,47.69411,1401.55,11.895442,47.694088,1401.5,11.895443,47.694065,1401.48,11.895448,47.694042,1401.52,11.895457,47.69402,1401.62,11.895471,47.693998,1401.82,11.89549,47.693976,1402.11,11.895512,47.693954,1402.43,11.895537,47.693933,1402.77,11.895564,47.693915,1403.07,11.895593,47.6939,1403.33,11.895626,47.693886,1403.58,11.895661,47.693874,1403.82,11.895697,47.693864,1404.08,11.895733,47.693856,1404.35,11.89577,47.69385,1404.66,11.895808,47.693847,1404.99,11.895847,47.693845,1405.32,11.895884,47.693845,1405.66,11.895921,47.693846,1405.99,11.895955,47.693849,1406.32,11.895989,47.693853,1406.67,11.896022,47.693859,1407.01,11.896053,47.693865,1407.3,11.896082,47.693872,1407.53,11.89611,47.69388,1407.68,11.896135,47.693888,1407.78,11.896159,47.693897,1407.83,11.896181,47.693907,1407.85,11.896203,47.693918,1407.85,11.896223,47.693929,1407.82,11.896242,47.693942,1407.75,11.896259,47.693955,1407.66,11.896275,47.693969,1407.58,11.896289,47.693983,1407.54,11.896301,47.693998,1407.52,11.896311,47.694014,1407.52,11.896319,47.69403,1407.54,11.896326,47.694047,1407.61,11.896331,47.694063,1407.72,11.896335,47.69408,1407.89,11.896337,47.694096,1408.11,11.896338,47.694113,1408.37,11.896338,47.69413,1408.67,11.896337,47.694146,1408.98,11.896334,47.694162,1409.35,11.896329,47.694178,1409.76,11.896324,47.694193,1410.2,11.896318,47.694208,1410.62,11.896311,47.694222,1411.0,11.896303,47.694236,1411.34,11.896295,47.694248,1411.66,11.896286,47.694261,1411.96,11.896276,47.694272,1412.23,11.896265,47.694282,1412.48,11.896253,47.69429,1412.67,11.89624,47.694298,1412.82,11.896225,47.694304,1412.95,11.89621,47.694309,1413.08,11.896194,47.694313,1413.23,11.896177,47.694315,1413.4,11.896159,47.694316,1413.58,11.89614,47.694315,1413.76,11.896121,47.694313,1413.95,11.896101,47.694311,1414.16,11.89608,47.694307,1414.4,11.896058,47.694301,1414.66,11.896035,47.694295,1414.93,11.896013,47.694288,1415.19,11.895991,47.694279,1415.42,11.89597,47.69427,1415.62,11.895949,47.694261,1415.82,11.895929,47.69425,1416.0,11.895909,47.694238,1416.15,11.895892,47.694225,1416.28,11.895877,47.694212,1416.37,11.895863,47.694197,1416.43,11.89585,47.694182,1416.46,11.895839,47.694166,1416.5,11.895831,47.694149,1416.56,11.895824,47.694131,1416.66,11.895818,47.694112,1416.77,11.895815,47.694093,1416.89,11.895814,47.694073,1417.0,11.895817,47.694053,1417.11,11.895824,47.694032,1417.2,11.895834,47.694011,1417.29,11.895848,47.69399,1417.38,11.895864,47.693969,1417.46,11.895883,47.69395,1417.56,11.895906,47.693931,1417.66,11.895932,47.693913,1417.77,11.89596,47.693895,1417.88,11.895991,47.693879,1418.0,11.896021,47.693864,1418.12,11.896053,47.693849,1418.25,11.896087,47.693836,1418.38,11.896122,47.693824,1418.52,11.896156,47.693813,1418.67,11.89619,47.693804,1418.82,11.896222,47.693796,1419.01,11.896253,47.69379,1419.21,11.896285,47.693785,1419.42,11.896315,47.693781,1419.62,11.896346,47.693779,1419.78,11.896376,47.693778,1419.9,11.896406,47.693779,1419.99,11.896436,47.69378,1420.07,11.896466,47.693783,1420.14,11.896496,47.693786,1420.22,11.896526,47.693791,1420.29,11.896557,47.693796,1420.35,11.896587,47.693802,1420.41,11.896617,47.693809,1420.49,11.896647,47.693817,1420.61,11.896676,47.693826,1420.78,11.896706,47.693836,1420.99,11.896734,47.693847,1421.21,11.896762,47.693859,1421.44,11.896788,47.693871,1421.64,11.896813,47.693885,1421.8,11.896838,47.693899,1421.94,11.896861,47.693914,1422.07,11.896882,47.69393,1422.23,11.896901,47.693945,1422.42,11.896918,47.693961,1422.66,11.896932,47.693977,1422.94,11.896945,47.693993,1423.24,11.896957,47.694009,1423.54,11.896967,47.694024,1423.82,11.896975,47.69404,1424.09,11.896981,47.694056,1424.36,11.896986,47.694071,1424.62,11.896989,47.694087,1424.87,11.896992,47.694101,1425.09,11.896994,47.694116,1425.31,11.896996,47.69413,1425.53,11.896996,47.694144,1425.72,11.896996,47.694157,1425.88,11.896994,47.694171,1426.0,11.896992,47.694183,1426.05,11.896989,47.694195,1426.02,11.896985,47.694207,1425.98,11.89698,47.694219,1425.96,11.896974,47.69423,1426.0,11.896966,47.694241,1426.12,11.896957,47.694252,1426.3,11.896947,47.694263,1426.5,11.896936,47.694273,1426.71,11.896924,47.694282,1426.91,11.89691,47.69429,1427.09,11.896895,47.694299,1427.27,11.896879,47.694306,1427.45,11.896863,47.694313,1427.65,11.896846,47.694318,1427.89,11.896829,47.694323,1428.19,11.896812,47.694327,1428.53,11.896795,47.69433,1428.89,11.896778,47.694332,1429.22,11.896761,47.694334,1429.49,11.896744,47.694335,1429.68,11.896728,47.694335,1429.83,11.896712,47.694334,1429.94,11.896696,47.694333,1430.02,11.89668,47.69433,1430.09,11.896665,47.694328,1430.15,11.89665,47.694325,1430.2,11.896635,47.69432,1430.22,11.89662,47.694315,1430.19,11.896606,47.694309,1430.09,11.896592,47.694301,1429.91,11.896579,47.694292,1429.66,11.896565,47.694282,1429.37,11.896553,47.69427,1429.05,11.89654,47.694257,1428.75,11.896527,47.694242,1428.42,11.896514,47.694226,1428.05,11.896502,47.694209,1427.69,11.896491,47.69419,1427.4,11.896482,47.694169,1427.22,11.896475,47.694148,1427.18,11.896468,47.694124,1427.23,11.896464,47.694099,1427.35,11.896463,47.694074,1427.54,11.896465,47.694049,1427.75,11.896472,47.694023,1428.03,11.896481,47.693996,1428.37,11.896494,47.693968,1428.76,11.896509,47.693942,1429.15,11.896528,47.693918,1429.52,11.89655,47.693896,1429.87,11.896575,47.693874,1430.22,11.896604,47.693854,1430.57,11.896634,47.693836,1430.91,11.896666,47.69382,1431.25,11.896701,47.693806,1431.59,11.896738,47.693794,1431.92,11.896777,47.693784,1432.25,11.896816,47.693776,1432.58,11.896853,47.69377,1432.92,11.896889,47.693767,1433.28,11.896926,47.693767,1433.64,11.896961,47.693768,1434.01,11.896996,47.693771,1434.37,11.897029,47.693774,1434.71,11.897061,47.693779,1435.06,11.897092,47.693786,1435.4,11.897122,47.693794,1435.73,11.897151,47.693802,1436.04,11.897178,47.693811,1436.31,11.897204,47.69382,1436.53,11.897229,47.69383,1436.7,11.897253,47.69384,1436.85,11.897276,47.69385,1437.0,11.897298,47.693861,1437.18,11.897319,47.693873,1437.4,11.897339,47.693885,1437.63,11.897358,47.693897,1437.88,11.897376,47.69391,1438.12,11.897394,47.693923,1438.34,11.897411,47.693936,1438.55,11.897428,47.693951,1438.76,11.897445,47.693965,1438.95,11.897461,47.69398,1439.12,11.897477,47.693995,1439.27,11.897492,47.69401,1439.35,11.897507,47.694025,1439.4,11.897521,47.694041,1439.43,11.897534,47.694056,1439.47,11.897546,47.694071,1439.55,11.897556,47.694087,1439.69,11.897566,47.694102,1439.87,11.897574,47.694116,1440.06,11.897581,47.694131,1440.26,11.897587,47.694146,1440.42,11.897592,47.694161,1440.57,11.897596,47.694175,1440.69,11.897599,47.69419,1440.81,11.897602,47.694204,1440.94,11.897603,47.694218,1441.07,11.897603,47.694233,1441.22,11.897603,47.694247,1441.37,11.897601,47.69426,1441.52,11.897599,47.694274,1441.69,11.897596,47.694288,1441.87,11.897592,47.694302,1442.08,11.897588,47.694316,1442.3,11.897582,47.694331,1442.53,11.897577,47.694344,1442.75,11.897571,47.694357,1442.95,11.897564,47.69437,1443.13,11.897557,47.694382,1443.31,11.89755,47.694394,1443.46,11.897542,47.694405,1443.59,11.897534,47.694415,1443.68,11.897526,47.694425,1443.72,11.897517,47.694434,1443.71,11.897507,47.694442,1443.68,11.897497,47.69445,1443.66,11.897486,47.694458,1443.68,11.897475,47.694464,1443.73,11.897463,47.694471,1443.8,11.89745,47.694477,1443.89,11.897436,47.694482,1444.0,11.897422,47.694486,1444.14,11.897406,47.69449,1444.35,11.89739,47.694494,1444.61,11.897373,47.694497,1444.88,11.897355,47.694498,1445.11,11.897338,47.694499,1445.27,11.89732,47.694499,1445.34,11.897301,47.694498,1445.37,11.897282,47.694497,1445.35,11.897263,47.694493,1445.27,11.897245,47.694489,1445.14,11.897228,47.694483,1444.93,11.897211,47.694476,1444.65,11.897195,47.694467,1444.33,11.89718,47.694457,1443.99,11.897167,47.694444,1443.66,11.897154,47.69443,1443.31,11.897142,47.694414,1442.92,11.897132,47.694396,1442.54,11.897124,47.694377,1442.23,11.897119,47.694357,1442.05,11.897118,47.694335,1442.02,11.89712,47.694311,1442.12,11.897124,47.694286,1442.3,11.897132,47.694261,1442.48,11.897144,47.694238,1442.64,11.897159,47.694216,1442.74,11.897177,47.694194,1442.85,11.897199,47.694174,1442.95,11.897224,47.694154,1443.06,11.897251,47.694137,1443.18,11.897282,47.694121,1443.31,11.897316,47.694106,1443.43,11.897353,47.694093,1443.57,11.89739,47.694082,1443.72,11.897426,47.694075,1443.9,11.897461,47.69407,1444.12,11.897497,47.694067,1444.35,11.897532,47.694067,1444.61,11.897567,47.694069,1444.88,11.897599,47.694073,1445.16,11.89763,47.694078,1445.46,11.89766,47.694086,1445.78,11.897689,47.694096,1446.11,11.897717,47.694106,1446.42,11.897743,47.694117,1446.69,11.897769,47.694127,1446.9,11.897793,47.694138,1447.07,11.897816,47.694149,1447.22,11.897838,47.694161,1447.36,11.89786,47.694173,1447.51,11.897881,47.694185,1447.67,11.897902,47.694197,1447.83,11.897923,47.694209,1447.98,11.897942,47.694221,1448.12,11.89796,47.694233,1448.23,11.897978,47.694243,1448.33,11.897994,47.694254,1448.41,11.898009,47.694264,1448.48,11.898024,47.694274,1448.52,11.898038,47.694285,1448.54,11.898052,47.694297,1448.52,11.898065,47.69431,1448.48,11.898077,47.694322,1448.42,11.898088,47.694336,1448.35,11.898099,47.69435,1448.29,11.898108,47.694364,1448.22,11.898117,47.69438,1448.15,11.898125,47.694395,1448.07,11.898132,47.694411,1448.01,11.898136,47.694427,1447.97,11.898139,47.694442,1447.95,11.898141,47.694457,1447.93,11.898141,47.694472,1447.93,11.89814,47.694487,1447.97,11.898137,47.694502,1448.03,11.898133,47.694517,1448.16,11.898128,47.694533,1448.33,11.898122,47.694548,1448.52,11.898114,47.694562,1448.71,11.898107,47.694576,1448.86,11.898098,47.694589,1448.96,11.898089,47.694601,1449.05,11.898078,47.694612,1449.12,11.898068,47.694623,1449.19,11.898058,47.694634,1449.27,11.898048,47.694644,1449.36,11.898038,47.694653,1449.47,11.898028,47.694662,1449.58,11.898018,47.694671,1449.67,11.898008,47.694679,1449.73,11.897997,47.694687,1449.76,11.897988,47.694695,1449.78,11.897977,47.694702,1449.77,11.897967,47.694709,1449.73,11.897957,47.694716,1449.66,11.897946,47.694723,1449.54,11.897936,47.694729,1449.37,11.897925,47.694736,1449.18,11.897914,47.694743,1448.98,11.897902,47.694749,1448.79,11.89789,47.694756,1448.61,11.897877,47.694762,1448.4,11.897864,47.694768,1448.21,11.89785,47.694774,1448.05,11.897836,47.694781,1447.95,11.897821,47.694787,1447.92,11.897806,47.694793,1447.95,11.89779,47.694799,1448.01,11.897774,47.694805,1448.09,11.897757,47.69481,1448.18,11.897739,47.694815,1448.26,11.89772,47.69482,1448.35,11.897701,47.694825,1448.45,11.897681,47.69483,1448.59,11.897662,47.694834,1448.77,11.897642,47.694838,1449.0,11.897622,47.694842,1449.28,11.897602,47.694845,1449.59,11.897581,47.694848,1449.91,11.897561,47.694852,1450.24,11.897541,47.694855,1450.59,11.89752,47.694858,1450.96,11.8975,47.69486,1451.34,11.89748,47.694863,1451.69,11.897461,47.694866,1452.0,11.897442,47.694868,1452.24,11.897425,47.694871,1452.45,11.897408,47.694874,1452.63,11.897391,47.694876,1452.79,11.897374,47.694878,1452.96,11.897357,47.694879,1453.11,11.897341,47.69488,1453.24,11.897326,47.694881,1453.37,11.897309,47.694881,1453.51,11.897293,47.694882,1453.68,11.897275,47.694882,1453.88,11.897256,47.694882,1454.1,11.897238,47.694882,1454.33,11.897219,47.694881,1454.57,11.8972,47.694881,1454.8,11.897182,47.694882,1455.04,11.897163,47.694882,1455.28,11.897144,47.694882,1455.52,11.897126,47.694882,1455.76,11.897108,47.694883,1455.98,11.897091,47.694885,1456.18,11.897074,47.694887,1456.35,11.897057,47.69489,1456.53,11.897041,47.694892,1456.72,11.897024,47.694894,1456.95,11.897008,47.694897,1457.22,11.896991,47.694899,1457.52,11.896975,47.694901,1457.84,11.896959,47.694904,1458.17,11.896942,47.694906,1458.52,11.896926,47.694907,1458.88,11.896909,47.694909,1459.27,11.896892,47.694911,1459.66,11.896875,47.694912,1460.07,11.896858,47.694913,1460.47,11.89684,47.694915,1460.89,11.896821,47.694916,1461.32,11.896803,47.694917,1461.75,11.896784,47.694918,1462.18,11.896765,47.694919,1462.6,11.896746,47.69492,1463.02,11.896726,47.694922,1463.43,11.896706,47.694923,1463.83,11.896686,47.694924,1464.24,11.896666,47.694926,1464.65,11.896646,47.694927,1465.08,11.896625,47.694929,1465.54,11.896604,47.694932,1465.99,11.896584,47.694934,1466.4,11.896564,47.694936,1466.76,11.896545,47.694939,1467.06,11.896526,47.694943,1467.32,11.896508,47.694946,1467.54,11.896491,47.69495,1467.72,11.896475,47.694953,1467.85,11.896461,47.694956,1467.94,11.896449,47.69496,1467.99,11.896437,47.694963,1468.0,11.896426,47.694966,1467.95,11.896415,47.694969,1467.85,11.896404,47.694972,1467.68,11.896394,47.694975,1467.43,11.896384,47.694978,1467.15,11.896375,47.694981,1466.84,11.896364,47.694983,1466.52,11.896354,47.694985,1466.2,11.896343,47.694986,1465.84,11.896332,47.694988,1465.48,11.89632,47.694989,1465.13,11.896307,47.69499,1464.8,11.896293,47.694991,1464.48,11.896277,47.694992,1464.17,11.89626,47.694993,1463.88,11.896242,47.694994,1463.62,11.896224,47.694994,1463.41,11.896205,47.694995,1463.26,11.896186,47.694995,1463.17,11.896165,47.694996,1463.11,11.896145,47.694996,1463.05,11.896125,47.694997,1462.97,11.896105,47.694998,1462.86,11.896085,47.694999,1462.74,11.896065,47.695,1462.61,11.896045,47.695002,1462.49,11.896026,47.695003,1462.37,11.896007,47.695005,1462.28,11.895989,47.695006,1462.21,11.895971,47.695008,1462.13,11.895953,47.695009,1462.02,11.895937,47.695011,1461.83,11.895921,47.695012,1461.58,11.895906,47.695014,1461.27,11.895892,47.695016,1460.92,11.895878,47.695017,1460.52,11.895862,47.695019,1460.09,11.895847,47.695022,1459.58,11.895831,47.695024,1458.99,11.895814,47.695026,1458.37,11.895797,47.695029,1457.81,11.895779,47.695032,1457.34,11.895761,47.695035,1456.99,11.895742,47.695039,1456.71,11.895722,47.695043,1456.49,11.895702,47.695047,1456.32,11.895681,47.69505,1456.18,11.895659,47.695054,1456.12,11.895636,47.695058,1456.12,11.895613,47.695062,1456.15,11.895589,47.695066,1456.18,11.895566,47.69507,1456.18,11.895542,47.695073,1456.15,11.895518,47.695077,1456.12,11.895494,47.69508,1456.06,11.895471,47.695082,1455.96,11.895448,47.695085,1455.78,11.895426,47.695087,1455.53,11.895405,47.695089,1455.21,11.895384,47.695091,1454.84,11.895364,47.695092,1454.41,11.895344,47.695093,1453.94,11.895325,47.695094,1453.41,11.895307,47.695095,1452.82,11.895289,47.695096,1452.18,11.895272,47.695096,1451.52,11.895254,47.695097,1450.87,11.895237,47.695097,1450.21,11.89522,47.695098,1449.51,11.895202,47.695099,1448.81,11.895185,47.6951,1448.14,11.895166,47.695101,1447.54,11.895147,47.695102,1447.01,11.895127,47.695103,1446.53,11.895106,47.695104,1446.09,11.895085,47.695106,1445.67,11.895062,47.695107,1445.26,11.895038,47.695109,1444.85,11.895012,47.69511,1444.46,11.894985,47.695112,1444.09,11.894959,47.695114,1443.75,11.894932,47.695115,1443.45,11.894906,47.695116,1443.2,11.894879,47.695117,1442.99,11.894852,47.695118,1442.81,11.894826,47.695119,1442.63,11.8948,47.695119,1442.42,11.894775,47.695119,1442.2,11.894751,47.695118,1442.0,11.894727,47.695118,1441.77,11.894704,47.695117,1441.48,11.894681,47.695116,1441.09,11.894659,47.695116,1440.59,11.894636,47.695116,1440.0,11.894614,47.695116,1439.35,11.894593,47.695116,1438.65,11.894572,47.695116,1437.94,11.894551,47.695116,1437.2,11.89453,47.695116,1436.41,11.89451,47.695117,1435.59,11.89449,47.695117,1434.76,11.89447,47.695119,1433.95,11.89445,47.69512,1433.15,11.89443,47.695122,1432.33,11.89441,47.695125,1431.52,11.89439,47.695128,1430.72,11.89437,47.695132,1429.95,11.894349,47.695137,1429.21,11.894327,47.695143,1428.47,11.894305,47.69515,1427.77,11.894284,47.695158,1427.09,11.894261,47.695167,1426.46,11.894239,47.695177,1425.87,11.894216,47.695189,1425.31,11.894193,47.695202,1424.79,11.894171,47.695216,1424.32],
                listOfTimePoints: [0.0,0.19999999999999998,0.39999999999999997,0.6,0.79999999999999993,1.0,1.2,1.4,1.5999999999999999,1.7999999999999998,2.0,2.1999999999999997,2.4,2.6,2.8,3.0,3.1999999999999997,3.4,3.5999999999999996,3.8,4.0,4.2,4.3999999999999995,4.6,4.8,5.0,5.2,5.3999999999999995,5.6,5.8,6.0,6.1999999999999993,6.3999999999999995,6.6,6.8,7.0,7.1999999999999993,7.3999999999999995,7.6,7.8,8.0,8.2,8.4,8.6,8.7999999999999989,9.0,9.2,9.4,9.6,9.7999999999999989,10.0,10.2,10.4,10.6,10.799999999999999,11.0,11.2,11.4,11.6,11.799999999999999,12.0,12.2,12.399999999999999,12.6,12.799999999999999,13.0,13.2,13.399999999999999,13.6,13.799999999999999,14.0,14.2,14.399999999999999,14.6,14.799999999999999,15.0,15.2,15.399999999999999,15.6,15.799999999999999,16.0,16.2,16.4,16.599999999999998,16.8,17.0,17.2,17.4,17.599999999999998,17.8,18.0,18.2,18.4,18.599999999999998,18.8,19.0,19.2,19.4,19.599999999999998,19.8,20.0,20.2,20.4,20.599999999999998,20.8,21.0,21.2,21.4,21.599999999999998,21.8,22.0,22.2,22.4,22.599999999999998,22.8,23.0,23.2,23.4,23.599999999999998,23.799999999999997,24.0,24.2,24.4,24.599999999999998,24.799999999999997,25.0,25.2,25.4,25.599999999999998,25.799999999999997,26.0,26.2,26.4,26.599999999999998,26.799999999999997,27.0,27.2,27.4,27.599999999999998,27.799999999999997,28.0,28.2,28.4,28.599999999999998,28.799999999999997,29.0,29.2,29.4,29.599999999999998,29.799999999999997,30.0,30.2,30.4,30.599999999999998,30.799999999999997,31.0,31.2,31.4,31.599999999999998,31.799999999999997,32.0,32.199999999999996,32.4,32.6,32.8,33.0,33.199999999999996,33.4,33.6,33.8,34.0,34.199999999999996,34.4,34.6,34.8,35.0,35.199999999999996,35.4,35.6,35.8,36.0,36.199999999999996,36.4,36.6,36.8,37.0,37.199999999999996,37.4,37.6,37.8,38.0,38.199999999999996,38.4,38.6,38.8,39.0,39.199999999999996,39.4,39.6,39.8,40.0,40.199999999999996,40.4,40.6,40.8,41.0,41.199999999999996,41.4,41.6,41.8,42.0,42.199999999999996,42.4,42.6,42.8,43.0,43.199999999999996,43.4,43.6,43.8,44.0,44.199999999999996,44.4,44.6,44.8,45.0,45.199999999999996,45.4,45.6,45.8,46.0,46.199999999999996,46.4,46.6,46.8,47.0,47.199999999999996,47.4,47.599999999999994,47.8,48.0,48.199999999999996,48.4,48.599999999999994,48.8,49.0,49.199999999999996,49.4,49.599999999999994,49.8,50.0,50.199999999999996,50.4,50.599999999999994,50.8,51.0,51.199999999999996,51.4,51.599999999999994,51.8,52.0,52.199999999999996,52.4,52.599999999999994,52.8,53.0,53.199999999999996,53.4,53.599999999999994,53.8,54.0,54.199999999999996,54.4,54.599999999999994,54.8,55.0,55.199999999999996,55.4,55.599999999999994,55.8,56.0,56.199999999999996,56.4,56.599999999999994,56.8,57.0,57.199999999999996,57.4,57.599999999999994,57.8,58.0,58.199999999999996,58.4,58.599999999999994,58.8,59.0,59.199999999999996,59.4,59.599999999999994,59.8,60.0,60.199999999999996,60.4,60.599999999999994,60.8,61.0,61.199999999999996,61.4,61.599999999999994,61.8,62.0,62.199999999999996,62.4,62.599999999999994,62.8,63.0,63.199999999999996,63.4,63.599999999999994,63.8,64.0,64.2,64.399999999999991,64.6,64.8,65.0,65.2,65.399999999999991,65.6,65.8,66.0,66.2,66.399999999999991,66.6,66.8,67.0,67.2,67.399999999999991,67.6,67.8,68.0,68.2,68.399999999999991,68.6,68.8,69.0,69.2,69.399999999999991,69.6,69.8,70.0,70.2,70.399999999999991,70.6,70.8,71.0,71.2,71.399999999999991,71.6,71.8,72.0,72.2,72.399999999999991,72.6,72.8,73.0,73.2,73.399999999999991,73.6,73.8,74.0,74.2,74.399999999999991,74.6,74.8,75.0,75.2,75.399999999999991,75.6,75.8,76.0,76.2,76.399999999999991,76.6,76.8,77.0,77.2,77.399999999999991,77.6,77.8,78.0,78.2,78.399999999999991,78.6,78.8,79.0,79.2,79.399999999999991,79.6,79.8,80.0,80.2,80.399999999999991,80.6,80.8,81.0,81.2,81.399999999999991,81.6,81.8,82.0,82.2,82.399999999999991,82.6,82.8,83.0,83.2,83.399999999999991,83.6,83.8,84.0,84.2,84.399999999999991,84.6,84.8,85.0,85.2,85.399999999999991,85.6,85.8,86.0,86.2,86.399999999999991,86.6,86.8,87.0,87.2,87.399999999999991,87.6,87.8,88.0,88.2,88.399999999999991,88.6,88.8,89.0,89.2,89.399999999999991,89.6,89.8,90.0,90.2,90.399999999999991,90.6,90.8,91.0,91.2,91.399999999999991,91.6,91.8,92.0,92.2,92.399999999999991,92.6,92.8,93.0,93.2,93.399999999999991,93.6,93.8,94.0,94.2,94.399999999999991,94.6,94.8,95.0,95.199999999999989,95.399999999999991,95.6,95.8,96.0,96.199999999999989,96.399999999999991,96.6,96.8,97.0,97.199999999999989,97.399999999999991,97.6,97.8,98.0,98.199999999999989,98.399999999999991,98.6,98.8,99.0,99.199999999999989,99.399999999999991,99.6,99.8,100.0,100.19999999999999,100.39999999999999,100.6,100.8,101.0,101.19999999999999,101.39999999999999,101.6,101.8,102.0,102.19999999999999,102.39999999999999,102.6,102.8,103.0,103.19999999999999,103.39999999999999,103.6,103.8,104.0,104.19999999999999,104.39999999999999,104.6,104.8,105.0,105.19999999999999,105.39999999999999,105.6,105.8,106.0,106.19999999999999,106.39999999999999,106.6,106.8,107.0,107.19999999999999,107.39999999999999,107.6,107.8,108.0,108.19999999999999,108.39999999999999,108.6,108.8,109.0,109.19999999999999,109.39999999999999,109.6,109.8,110.0,110.19999999999999,110.39999999999999,110.6,110.8,111.0,111.19999999999999,111.39999999999999,111.6,111.8,112.0,112.19999999999999,112.39999999999999,112.6,112.8,113.0,113.19999999999999,113.39999999999999,113.6,113.8,114.0,114.19999999999999,114.39999999999999,114.6,114.8,115.0,115.19999999999999,115.39999999999999,115.6,115.8,116.0,116.19999999999999,116.39999999999999,116.6,116.8,117.0,117.19999999999999,117.39999999999999,117.6,117.8,118.0,118.19999999999999,118.39999999999999,118.6,118.8,119.0,119.19999999999999,119.39999999999999,119.6,119.8,120.0,120.19999999999999,120.39999999999999,120.6,120.8,121.0,121.19999999999999,121.39999999999999,121.6,121.8,122.0,122.19999999999999,122.39999999999999,122.6,122.8,123.0,123.19999999999999,123.39999999999999,123.6,123.8,124.0,124.19999999999999,124.39999999999999,124.6,124.8,125.0,125.19999999999999,125.39999999999999,125.6,125.8,126.0,126.19999999999999,126.39999999999999,126.6,126.8,127.0,127.19999999999999,127.39999999999999,127.6,127.8,128.0,128.2,128.4,128.6,128.79999999999998,129.0,129.2,129.4,129.6,129.79999999999998,130.0,130.2,130.4,130.6,130.79999999999998,131.0,131.2,131.4,131.6,131.79999999999998,132.0,132.2,132.4,132.6,132.79999999999998,133.0,133.2,133.4,133.6,133.79999999999998,134.0,134.2,134.4,134.6,134.79999999999998,135.0],
                color: null
            };
            map.addTrack(window.theFlight);
        }

        window.zoomToFlightTrack = function () {
            map.zoomToTrack(theFlight.id);
        }

        window.sampleFlightTrackHeights = function () {
            map.showTrackHeightProfile(theFlight.id);

            map.onSampledTrackHeights = function (listOfTrackPointHeights) {
                theFlight.groundHeightProfile = listOfTrackPointHeights;

                map.heightProfileView.addGroundProfile(theFlight.groundHeightProfile);
            };

            map.sampleTrackHeights(theFlight);
        }

        window.addOsmBuildingsLayer = function () {
            var theLayer = {
                id: 'osmBuildingsLayer',
                name: 'Cesium OSM Buildings',
                type: 'OsmBuildingsLayer',
                isVisible: true
            };
            map.addLayer(theLayer);
        }

        window.removeOsmBuildingsLayer = function () {
            map.removeLayer('osmBuildingsLayer');
        }

        window.addTakeoffLocation = function () {
            var theLocation = {
                "id": "wheretofly-path-nagelspitz-start",
                "name": "SP Jägerkamp/Nagelspitz (NW-WNW, E)",
                "description": "",
                "type": "FlyingTakeoff",
                "latitude": 47.679201,
                "longitude": 11.90403,
                "altitude": 1612.0,
                "takeoffDirections": 1 + 16 + 256 + 1024 + 4096, // N,E,S,SW,W
                "isPlanTourLocation": false
            };
            map.addLocationList([theLocation]);
            map.zoomToLocation(theLocation);
        }

        window.nextLocationIndex = 0;
        window.addManyLocations = function () {

            map.setEntityClustering(false);

            let locationList = [];
            for (let index = window.nextLocationIndex; index < window.nextLocationIndex + 1000; index++) {
                locationList.push({
                    "id": "location-" + index,
                    "name": "Location " + index,
                    "description": "Location " + index,
                    "type": "Summit",
                    "latitude": 47.6764385 + 0.1 * (Math.random() - 0.5),
                    "longitude": 11.8710533 + 0.1 * (Math.random() - 0.5),
                    "elevation": 0.0
                });
            }

            map.addLocationList(locationList);

            window.nextLocationIndex += 1000;
        }

        window.addLayer = function () {
            var theLayer = {
                id: 'testLayer',
                name: 'Test Layer',
                type: 'CzmlLayer',
                isVisible: true,
                data: '[{"id":"document","name":"Schliersee Mountain Peaks","version":"1.0"},{"id":"rotwand","name":"Rotwand","description":"Rotwand","position":{"cartographicDegrees":[11.9345058,47.6502332,1934.0]},"label":{"text":"Rotwand 1884m","font":"14pt Lucida Console","style":"FILL_AND_OUTLINE","showBackground":false,"horizontalOrigin":"LEFT","verticalOrigin":"BOTTOM","heightReference":"NONE","fillColor":{"rgba":[255,255,255,255]},"outlineColor":{"rgba":[0,0,0,255]},"outlineWidth":10.0,"distanceDisplayCondition":{"distanceDisplayCondition":[0.1,20000.0]}},"polyline":{"positions":{"cartographicDegrees":[11.9345058,47.6502332,0.0,11.9345058,47.6502332,1934.0]},"width":3.0,"clampToGround":false,"material":{"solidColor":{"color":{"rgba":[255,255,255,255]}}},"distanceDisplayCondition":{"distanceDisplayCondition":[0.1,20000.0]}}}]'
            };
            map.addLayer(theLayer);
        }

        window.removeLayer = function () {
            map.removeLayer('testLayer');
        }

        window.showFlyingRange = function () {
            map.showFlyingRange({
                latitude: 47.6764385,
                longitude: 11.8710533,
                displayLatitude: "47.6764385",
                displayLongitude: "11.8710533",
                altitude: 1685.0,
                glideRatio: 8.5,
                gliderSpeed: 42.0,
                windDirection: 0.0,
                windSpeed: 0.0,
            });
        }

        window.addLiveTrack = function () {
            window.liveTrack = {
                id: 'live-track',
                name: 'Live Track',
                isFlightTrack: true,
                isLiveTrack: true,
                listOfTrackPoints: [],
                listOfTimePoints: [],
                groundHeightProfile: null,
                color: "ff8000"
            };
            map.addTrack(window.liveTrack);
        }

        window.updateLiveTrack = function () {
            var xhr = new XMLHttpRequest();
            xhr.onreadystatechange = function () {
                if (xhr.readyState === 4) {
                    if (xhr.responseText === '')
                        console.warn("xhr call returned nothing");
                    else {
                        var response = JSON.parse(xhr.responseText);
                        response.data.id = liveTrack.id;
                        response.data.isLiveTrack = true;
                        response.data.isFlightTrack = true;
                        map.updateLiveTrack(response.data);
                    }
                }
            };

            var url = 'https://wheretoflywebapi.azurewebsites.net/api/LiveTrack?id=where-to-fly://TestLiveTrack/dummy';

            var lastTrackPointTime = map.getTrackLastTrackPointTime(liveTrack.id);
            if (lastTrackPointTime !== null) {
                var time = new Date(lastTrackPointTime * 1000.0).toISOString();
                url += "&time=" + encodeURIComponent(time);
            }

            xhr.open('GET', url);
            xhr.send();
        }

        window.zoomToLiveTrack = function () {
            map.zoomToTrack(liveTrack.id);
        }

        window.removeLiveTrack = function () {
            map.removeTrack(liveTrack.id);
        }

        window.setCompassTarget = function () {
            map.setCompassTarget({
                title: 'Brecherspitz Vorgipfel',
                latitude: 47.675028,
                longitude: 11.86457,
                altitude: 1649.0,
                displayLatitude: "47.67°",
                displayLongitude: "11.86",
                distanceInKm: 0.652,
                heightDifferenceInMeter: 345,
                directionAngle: 67,
                zoomToPolyline: true,
                hideTargetLocation: false
            });
        }

        window.setCompassDirection = function () {
            map.setCompassTarget({
                title: "Fixed direction 240°",
                latitude: 47.5772,
                longitude: 12.6537,
                directionAngle: 240,
                distanceInKm: null,
                heightDifferenceInMeter: null,
                zoomToPolyline: false,
                hideTargetLocation: true
            });
        }

        window.clearCompass = function () {
            map.clearCompass();
        }

        window.changeMyPosition = function () {
            map.updateMyLocation({
                latitude: 47.66787,
                longitude: 11.85125,
                altitude: 1364.0,
                zoomToLocation: false
            });

            window.setCompassTarget();
        }

    </script>

</body>
</html>
