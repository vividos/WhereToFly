<Project Sdk="MSBuild.Sdk.Extras/3.0.38">

  <PropertyGroup>
    <TargetFrameworks>netstandard2.0;MonoAndroid12.0</TargetFrameworks>
    <TargetFrameworks Condition=" '$(OS)' == 'Windows_NT' ">$(TargetFrameworks);uap10.0.19041</TargetFrameworks>
    <Description>Where-to-fly App MapView</Description>
    <EnableDefaultCompileItems>false</EnableDefaultCompileItems>
  </PropertyGroup>

  <ItemGroup>
    <EmbeddedResource Remove="**" />
    <Compile Include="**\*.shared.cs" />
    <Compile Include="**\*.shared.*.cs" />
    <PackageReference Include="Xamarin.Forms" Version="5.0.0.2401" />
  </ItemGroup>

  <ItemGroup Condition=" $(TargetFramework.StartsWith('netstandard')) ">
    <Compile Include="**\*.netstandard.cs" />
    <Compile Include="**\*.netstandard.*.cs" />
  </ItemGroup>

  <ItemGroup Condition=" $(TargetFramework.StartsWith('uap10.0')) ">
    <Compile Include="**\*.uwp.cs" />
    <Compile Include="**\*.uwp.*.cs" />
    <SDKReference Include="WindowsMobile, Version=10.0.19041.0">
      <Name>Windows Mobile Extensions for the UWP</Name>
    </SDKReference>
  </ItemGroup>

  <ItemGroup Condition=" $(TargetFramework.StartsWith('MonoAndroid')) ">
    <Compile Include="**\*.android.cs" />
    <Compile Include="**\*.android.*.cs" />
  </ItemGroup>

  <!-- copy assets from the WebLib project -->
  <Target Name="CopyAssets" BeforeTargets="_CreateManagedLibraryResourceArchive">
    <ItemGroup>
      <AssetSourceFiles
        Include="../../Shared/WebLib/dist/**/*.*"
        Exclude="../../Shared/WebLib/dist/**/*.map" />
    </ItemGroup>
    <Message Text="Copying Assets..." />
    <Copy
      UseHardlinksIfPossible="true"
      SourceFiles="@(AssetSourceFiles)"
      DestinationFolder="$(MSBuildThisFileDirectory)Assets/weblib/%(RecursiveDir)" />
    <!-- dynamically add copied files to the AndroidAsset item group -->
    <CreateItem Include="$(MSBuildThisFileDirectory)Assets/weblib/**/*.*">
      <Output TaskParameter="Include" ItemName="AndroidAsset" />
    </CreateItem>
  </Target>

  <Target Name="CleanAssets" AfterTargets="Clean">
    <Message Text="Deleting Assets folder..." />
    <RemoveDir Directories="$(MSBuildThisFileDirectory)Assets" />
  </Target>

  <!-- add assets as AndroidAsset or Content -->
  <ItemGroup Condition=" $(TargetFramework.StartsWith('MonoAndroid')) ">
    <!-- need at least one file in AndroidAsset at .csproj load time, or the
        _CreateManagedLibraryResourceArchive target is not run at all -->
    <AndroidAsset Include="../../Shared/WebLib/Readme.md" />
    <AndroidAsset Include="Assets\**\*.*" />
  </ItemGroup>

  <ItemGroup Condition=" $(TargetFramework.StartsWith('uap10.0')) ">
    <Content Include="Assets\**\*.*" />
  </ItemGroup>

  <ItemGroup>
    <ProjectReference Include="..\..\Shared\WebLib\WhereToFly.Shared.WebLib.csproj" />
  </ItemGroup>

</Project>
